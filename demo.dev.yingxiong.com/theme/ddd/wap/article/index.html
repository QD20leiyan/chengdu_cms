{include file="../../layouts/wap/header.html"}
<link rel="stylesheet" href="{$smarty.const.STATIC_DOMAIN}3.0/m/css/news_lists.css?{$smarty.const.VERSION}">
<div class="top_H"></div>
<div class="d_news">
	<div class="d_news_header">新闻资讯</div>
	<div class="d_news_nav" data-id="{$alias}">
		<li class="{if $alias eq zonghe}bactive{else} {/if}">
			<a href="{myurl name='article/list, alias=>zonghe'}">资讯</a>
		</li>
		<li class="{if $alias eq xinwen}bactive{else} {/if}">
			<a href="{myurl name='article/list, alias=>xinwen'}">新闻</a>
		</li>
		<li class="{if $alias eq gonggao}bactive{else} {/if}">
			<a href="{myurl name='article/list, alias=>gonggao'}">公告</a>
		</li>
		<li class="{if $alias eq huodong}bactive{else} {/if}">
			<a href="{myurl name='article/list, alias=>gonglve'}">活动</a>
		</li>
	</div>
	<div class="d_news_lists">
		<ul class="d_news_list">
			<!-- <li><span>关于游戏漏洞恶意刷道具处理办法如下所示</span><i>[05/28]</i></li></li> -->
		</ul>
		<div class="dropload-down">
            <div class="dropload-noData">下拉加载更多...</div>
        </div>
	</div>
</div>
{include file="../../layouts/wap/footer.html"}
<script>
	var isScroll = 1; //是否可以滚动
	var page = 1; //页数
	var alias = $(".d_news_nav").attr("data-id"); //类型
	var ajaxUrl = '{myurl name="commonMethod/ajax-get-list"}';
	getListFu();
	window.onscroll = function() {
		var winH = window.innerHeight; //屏幕高度
		var allH = document.body.scrollHeight; //总高度
		var topH = window.pageYOffset; //滚动高度
		if((allH - (winH +
				topH) < 10) && isScroll == 1) {
			isScroll = 0;
			$(".dropload-noData").html("数据加载中...")
			getListFu();
		}
	}

	function getListFu() {
		$.ajax({
			type: "get",
			url: ajaxUrl,
			data: {
				page: page++,
				alias: alias,
			},
			success: function(data) {
				var data = JSON.parse(data);
				if(data.status == 0 && data.msg.length > 0) {
					var result = '';
					for(var i = 0; i < data.msg.length; i++) {
						result += "<li><a href=" + data.msg[i].wapLinkUrl + "><span>" + data.msg[i].title + "</span><i>" + data.msg[i].created_at + "</i></a></li>";
					}
					$('.d_news_list').append(result);
					$(".dropload-noData").html("上拉加载更多...<i></i>");
					isScroll = 1;
				} else {
					$(".dropload-noData").html("没有更多信息了...");
				}
			},
			error: function(data) {
				console.log(data);
			}
		});
	}
</script>
</body>

</html>