<!DOCTYPE html>
<html>
<head>
	<title>520全民表白节</title>
	<meta charset="utf-8">
	<meta name="viewport" content="initial-scale=1,maximum-scale=1, minimum-scale=1">
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
	<meta content="yes" name="apple-mobile-web-app-capable">
	<meta content="black" name="apple-mobile-web-app-status-bar-style">
	<meta content="telephone=no" name="format-detection">
	<link rel="stylesheet" type="text/css" href="css/wapReset.css">
	<link rel="stylesheet" type="text/css" href="public/yx_swiper.min.css">
	<link rel="stylesheet" type="text/css" href="css/active.css">
	<script type="text/javascript" src="public/resetRem.js"></script>
    <script>
            (function(doc, win) {
                var docEl = doc.documentElement,
                    // 手机旋转事件,大部分手机浏览器都支持 onorientationchange 如果不支持，可以使用原始的 resize
                    resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize',
                    recalc = function() {
                        //clientWidth: 获取对象可见内容的宽度，不包括滚动条，不包括边框
                        var clientWidth = docEl.clientWidth;
                        if(!clientWidth) return;
                        docEl.style.fontSize = 16 * (clientWidth / 320) + 'px';
                    };

                recalc();
                //判断是否支持监听事件 ，不支持则停止
                if(!doc.addEventListener) return;
                //注册翻转事件
                win.addEventListener(resizeEvt, recalc, false);

            })(document, window);
        </script>
</head>
<body>
	<section class="a-container">
        <section class="a-top">
            <a class="return" href="index.html"><img src="images/return.png" alt=""></a>
            <img src="images/logo4.png">
        </section>
		<section class="a-item2">
			<p>欢迎您，<span>枪战の王者</span></p>
		</section> 
		<section class="a-item3">
			<div>
				<img id="rotate" src="images/cj_pan.png">
                <img src="images/light2.png" alt="" class="light light2">
                <img src="images/light1.png" alt="" class="light light1">
				<div class="p-all-center">
                    <!-- <img src="images/pointer.png" alt=""> -->
					<img id="cj_start_btn" src="images/cj_zz1.png" class="pointer">
				</div>
			</div>
			<a href="javascript:;" class="gift_look"><img src="images/gift_look.png" alt=""></a>
		</section> 
	</section>
    <section class="b-container">
        <section class="b-btn">
            <a class="download" href="index.html"><img src="images/button_76.png" alt=""></a>
             <a class="share_other" href="index.html"><img src="images/button_share.png" alt=""></a>
        </section>
        <section class="b-open_style">
            <img src="images/1.png" alt="">
            <ul class="act_info">
                <li>
                    <i>1</i><p>活动时间：5月19日-5月28日24:00</p>
                </li>
                <li>
                    <i>2</i><p>活动期间，每个微信账号拥有1次抽奖机会</p>
                </li>
                <li>
                    <i>3</i><p><span>游戏内物品奖励：</span> 游戏礼包请打开《全民枪战2》游戏-任务-兑换礼品-进行兑换</p>
                </li>
                <li>
                    <i>4</i><p><span>实物奖励：</span> 520陈赤赤定制款巧克力将于活动结束后的10个工作日内寄出，收件地址一定要填写正确噢~否则会影响收货</p>
                </li>
            </ul>
        </section>
        <section class="b-open_style b-open_style2">
            <img src="images/2.png" alt="" class="img2">
            <ul class="act_info">
                <li>
                    <i>1</i><p>天才巧克力（72g浓醇黑巧克力）</p>
                </li>
                <li>
                    <i>2</i><p>陈赤赤520限定巧克（72g浓醇黑巧克力）</p>
                </li>
                <li>
                    <i>3</i><p>经典陈赤赤头像（永久）</p>
                </li>
                <li>
                    <i>4</i><p>天才陈赤赤限定头像（永久）</p>
                </li>
                 <li>
                    <i>5</i><p>丘比特爱弓（永久）</p>
                </li>
                <li>
                    <i>6</i><p>红唇气球（永久）</p>
                </li>
                <li>
                    <i>7</i><p>浪漫巴雷特（5天）</p>
                </li>
                <li>
                    <i>8</i><p>风色杀手包（5天）</p>
                </li>
            </ul>
        </section>
    </section>
    <section class="c-container">
         <section class="b-focus">
            <img src="images/3.png" alt="">
            <div class="focus_info">
                <div></div>
                <div></div>
            </div>
            <ul class="act_info">
                <li>
                    <i>1</i><p><span>CA温馨提示：</span>同类型礼包仅可兑换一次  </p>
                </li>
                <li>
                    <i>2</i><p>如有活动礼包问题，请与《全民枪战2》官方客服联系。</p>
                </li>
                <li>
                    <i>3</i><p>客服联系方式——关注“quanminqiangzhan”公众号——“新兵计划”——“在线客服”</p>
                </li>
                <li>
                    <i>4</i><p>本活动由《全民枪战2》运营团队最终解释</p>
                </li>
            </ul>
        </section>
    </section>
	<section class="a-dwon-box">
		<a class="p-all-center" href="javascript:"></a>
	</section>
	<!-- 这是弹窗 -->
	<section class="a-tc">
		<div class="p-all-center">
			<h1>恭喜中奖</h1>
			<h2>您的兑换码为：</h2>
			<label>12xyz7fgs8</label>
			<p>长按复制</p>
			<a href="javascript:"></a>
			<i class="tc-close"></i>
		</div>
	</section>
</body>
<script type="text/javascript" src="public/zepto.js"></script>
<script type="text/javascript" src="public/yx_swiper.min.js"></script>
<script type="text/javascript">
	$(function(){
		function init(){
			addSwiperIcon();	
			start_cj();
		};  

        //添加swiper插件轮播icon
        function addSwiperIcon(){
        	var len = $(".i5-banner .swiper-slide").length;
        	var html = "";
        	for(var i=0; i<len; i++){
        		if(i == 0){
        			html = html+'<label class="active"></label>';
        		}else{
        			html = html+'<label></label>';
        		}
        	}
        	$(".swiper-icon").append(html);
        	initSwiper(len);
        }
        //改变swiper插件轮播icon
        function changeSwiperIocn(index){
        	$(".swiper-icon label").removeClass("active");
        	$(".swiper-icon label").eq(index).addClass("active");  
        }
        //初始化swiper插件
        function initSwiper(len){
        	var mySwiper = new Swiper ('.swiper-container', {
        		loop: true,
        		autoplay: 4000,
        		autoplayDisableOnInteraction: false,
        		pagination: '.swiper-pagination',
        		slidesPerView: 'auto',
        		centeredSlides: true,
        		paginationClickable: true,
        		nextButton: '.swiper-button-next',
        		prevButton: '.swiper-button-prev',
        		onSlideChangeEnd: function(swiper){
        			var index = parseInt(swiper.activeIndex) - len;
        			if(index == len){
        				index = 0;
        			}
        			if(index == -1){
        				index = len - 1;
        			}
        			changeSwiperIocn(index);
        		}
        	});        
        }
        
var result_angle = [
    {a:7,p:0.08,t:'小黄鱼烧豆腐',id:'1'},
    {a:58,p:0.08,t:'烤肉筋一份',id:'2'},
    {a:109,p:0.08,t:'烤肥瘦一份',id:'3'},
    {a:160,p:0.35,t:'冰封/可乐任选1瓶',id:'4'},
    {a:211,p:0.35,t:'益可滋酸奶1瓶',id:'5'},
    {a:262,p:0.03,t:'9折买单',id:'6'},
    {a:313,p:0.03,t:'8折买单',id:'7'},
    {a:356,p:0.03,t:'8折买单',id:'8'}
];
var n = 0;
var rotate = {
    rotate_angle : 10, //起始位置为0
    flag_click : false, //转盘转动过程中不可再次触发
    calculate_result:function(type,during_time){//type:0,箭头转动,1,背景转动;during_time:持续时间(s)
        var self = this;
            type = type || 0; // 默认为箭头转动
            during_time = during_time || 1; // 默认为1s
        var rand_num = Math.ceil(Math.random() * 100); // 用来判断的随机数，1-100
        var result_index; // 最终要旋转到哪一块，对应result_angle的下标
        var start_pos = end_pos = 0; // 判断的角度值起始位置和结束位置
        for(var i in result_angle){
            start_pos = end_pos + 1; // 区块的起始值
            end_pos = end_pos + 100 * result_angle[i].p; // 区块的结束值
            if(rand_num >= start_pos && rand_num <= end_pos){ //如果随机数落在当前区块，那么获取到最终要旋转到哪一块
                result_index = i;
                break;
            }
        }
        var rand_circle = Math.ceil(Math.random() * 7) + 1; // 附加多转几圈，2-3
        self.flag_click = false; // 旋转结束前，不允许再次触发
        if(type == 0){ // 转动盘子
            var index_deg=result_angle[result_index].a;
            var lot_id = result_angle[result_index].id;// 最终要旋转到哪一块对应result_angle的下标的id
            self.rotate_angle= self.rotate_angle - rand_circle*360 - index_deg - self.rotate_angle % 360;
            $('#rotate').css({
                'transform': 'rotate('+self.rotate_angle+'deg)',
                '-ms-transform': 'rotate('+self.rotate_angle+'deg)',
                '-webkit-transform': 'rotate('+self.rotate_angle+'deg)',
                '-moz-transform': 'rotate('+self.rotate_angle+'deg)',
                '-o-transform': 'rotate('+self.rotate_angle+'deg)',
                'transition': 'transform ease-out '+during_time+'s',
                '-moz-transition': '-moz-transform ease-out '+during_time+'s',
                '-webkit-transition': '-webkit-transform ease-out '+during_time+'s',
                '-o-transition': '-o-transform ease-out '+during_time+'s'
                });
        }else{ // 转动指针
                self.rotate_angle = self.rotate_angle + rand_circle * 360 + result_angle[result_index].a - self.rotate_angle % 360;
                $('.pointer').css({
                    'transform': 'rotate('+self.rotate_angle+'deg)',
                    '-ms-transform': 'rotate('+self.rotate_angle+'deg)',
                    '-webkit-transform': 'rotate('+self.rotate_angle+'deg)',
                    '-moz-transform': 'rotate('+self.rotate_angle+'deg)',
                    '-o-transform': 'rotate('+self.rotate_angle+'deg)',
                    'transition': 'transform ease-out '+during_time+'s',
                    '-moz-transition': '-moz-transform ease-out '+during_time+'s',
                    '-webkit-transition': '-webkit-transform ease-out '+during_time+'s',
                    '-o-transition': '-o-transform ease-out '+during_time+'s'
                });
        }
        // 旋转结束后，不允许再次触发
        setTimeout(function(){ 
            self.flag_click = false;
            // 告诉结果
            $(".light1").removeClass("active");
            $(".light2").removeClass("active");
            alert("恭喜您，获得"+result_angle[result_index].t);
            console.log(lot_id);
        },during_time*1500);
    }
}
//灯光闪烁
$(".pointer").on("click",function(){
    n++;
    if(n == 1){
        rotate.calculate_result(1,1);
        $(".light1").addClass("active");
        $(".light2").addClass("active");
        return ; 
    }else if(n >= 2){
        alert("欢迎明天您的光临~");
    }
});

       });
</script>
</html>