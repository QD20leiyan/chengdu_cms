<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>直击心灵的2018预测</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content=" initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <meta name="format-detection" content="telephone=no">
    <meta name="full-screen" content="yes" />
    <meta name="x5-fullscreen" content="true" />
    <link href="css/swiper.min.css" rel="stylesheet" />
    <link href="css/index.css" rel="stylesheet" />
    <script>
        (function (doc, win) {
            var docEl = doc.documentElement,
            // 手机旋转事件,大部分手机浏览器都支持 onorientationchange 如果不支持，可以使用原始的 resize
                    resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize',
                    recalc = function () {
                        //clientWidth: 获取对象可见内容的宽度，不包括滚动条，不包括边框
                        var clientWidth = docEl.clientWidth;
                        if (!clientWidth) return;
                        docEl.style.fontSize = 16*(clientWidth / 320) + 'px';
                    };

            recalc();
            //判断是否支持监听事件 ，不支持则停止
            if (!doc.addEventListener) return;
            //注册翻转事件
            win.addEventListener(resizeEvt, recalc, false);
        })(document, window);
    </script>
</head>
<style>
    @font-face {
        font-family: "webFont";
        src: url(font/webfont.ttf) format('truetype');
        font-style: normal;
        font-weight: normal;
    }
    .content_box{
        overflow:hidden;
        width: 18.03125rem;
        height: 22.8125rem;
        background:url("images/con_bg.png");
        background-size: 100% 100%;
        text-align: center;
        position: absolute;
        left: 50%;
        top: 50%;
        margin-top: -12.5rem;
        margin-left: -9.015625rem;
    }
    .page4{
        background:url("images/bg.jpg") no-repeat;
        background-size:cover;
    }
</style>
<body>
<div class="wrap">
    <section class="swiper-container">
        <section class="swiper-wrapper">
            <section class="swiper-slide page1">
                <div class="content_box">
                    <p class="title"><img src="images/title.png" alt=""/></p>
                    <p class="light"><img src="images/light.png" alt=""/></p>
                    <p class="box1">这个测试可能引起你的不适，心脏病患者请慎点击</p>
                    <p class="box2">左滑开始</p>
                </div>
            </section>
            <section class="swiper-slide page2 swiper-no-swiping">
                <div class="content_box">
                    <p class="box3" data-name="aq">爱情</p>
                    <p class="box3" data-name="xy">学业</p>
                    <p class="box3" data-name="zc">职场</p>
                    <p class="box3" data-name="cy">财运</p>
                    <p class="box2">点击确认</p>
                </div>
            </section>
            <section class="swiper-slide page3 swiper-no-swiping">
                <div class="content_box">
                    <p class="zs"><img src="images/light1.png" alt=""/></p>
                    <p class="name">输入你的名字</p>
                    <p class="name_input"><input type="text" maxlength="6"/></p>
                    <p class="box2">点击确认</p>
                </div>
            </section>
            <section class="swiper-slide page4 swiper-no-swiping">
                <div class="content_box">
                    <p class="zs"><img src="images/light2.png" alt=""/></p>
                    <p class="type_info">XX的2018<i class="type">爱情</i></p>
                    <p class="txt">人生就是这样，有欢笑也有泪水。一部分人负责恋爱的欢笑，一部分人负责单身的泪水。</p>
                </div>
                <p class="qrcode"><img src="images/qrcode.png" alt=""/></p>
                <p class="qrcode_txt">扫一扫，查看自己的2018运势</p>
            </section>
            <section class="swiper-slide page5 swiper-no-swiping">
                <img src="images/share_img.png" alt="" class="jp_img"/>
                <p class="again">测试其他</p>
                <p class="save">&lt;长按保存图片&gt;</p>
            </section>

        </section>
    </section>
    <p class="from">本H5由超魔性手游《吃豆大作战》独家策划</p>
</div>

<!--遮罩层-->
<div id=loading10 style="display:none;position:fixed;left:0;top:0;z-index:999;background:rgba(0,0,0,1);width:100%;height:100%" class="js_load">
    <div style="width: 100px;height: 56px;position: absolute;left: 50%;top: 50%;margin: -28px -50px">
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6ODJDNTVGNjA0NDUxMTFFN0FEQzZFNUIwQkM3NUZFMjciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6ODJDNTVGNjE0NDUxMTFFN0FEQzZFNUIwQkM3NUZFMjciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4MkM1NUY1RTQ0NTExMUU3QURDNkU1QjBCQzc1RkUyNyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4MkM1NUY1RjQ0NTExMUU3QURDNkU1QjBCQzc1RkUyNyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pp8wa4IAAATlSURBVHja3FptiFRlFL7jzmzmJxu1KbvqoraGOOsuteZHioYf4EJmP6RAKvwjuEUgBIE/lP1V/Spig36U4gf9EgujMj8Q8TMoN2stc7VNbKxGW3drxZ0ZdzrHfS4cju+9c987c0emAw9z73vvPe855z3v+XiZWD6fdyqZYlqBzs7OihC8vb397u8op8IpHiHvBsJiXB8n/BrFJFGtAPNdRngQWBrVXGGZ1hDmEGo9no8hJMR9AmMmqgWvmnK50MOENYQqAkeAA4QrIQ0xlbCKgwnhDuEzwvWoV6ABwjuYeJG4t6EqfBsT9w3lcKEb6n48IRmCTxLf+vGORAGOJmk11uLj4157pEWNpcNEqrCb+IS65006z+L7eWqTm3hGqsBfhB411iiiUtbwTVZEnUb1rAc8S6oAR5tWwnSP52cIOTXWjN8hQkqMpzAm33EpB173lDmYuxWyWIVRjsnPCQXZOieVlQYJXYQnPfh9RZgpLOw1Zxd46dywUKzoXMJeQl9QBerV6tRCoR5Yy53we0IdYTIhQzirLPuzgfdZ8KsmXAMPl8YSnhKKS0+ps1HgDySpmBpnxtNgtXNIPvsJEwm3PHxfEwu9B5FoAPNwDmiCeyUM3/A7f9rsgTQy7IDhWQJ+2SbG+gMKLzd0PwRjWg2eJuEHIEvatpS4gs2X9LDMJFi+v8h6bCJc0KQkr/QPhmARuBbKwWcvIHbL8JeB2xRLt8CrWoz9QvgmCP+4xSRHCeexGnEoli2BAlm4SAsM1mWTE+KWbSQz/jqCsv4aUJJyOm4osqS1/o24S0z4BBeef9hPgbWEHYQJPhMcJDxLuF1iwavQG9T7vJOBK/d6hdH3CgjPtILwSgSWbywgvION/nQpirlcBArkw7ynFXjdI3lpF9odgQIXCVcLvJPRZbfeA/tQGtR7rM6Abc9qQVyWfEEYrXKCtPxgoU3sukfvfTyrum0TIGyPFp8gbELV+C7hNA+6x3y2JObiAnGJcBFPV9JzBc3EjxLeJKwTFWozFBos0uLsLi/CdZgeR4l9mPBPsaUEM91IeBVWlzQBil0uUoHxQni3E2PjzHZGjiRP+ZUsfgosJ3T4nNWcdk8RTG6nl9rHNf8m/AY30ivzDJT5ElEqcD/AH233EJ5d5m0su9v0TLU8VnkAqxcDj12EI9gDmh7CXHU2K9BqOG3L4+ivAx2ba6X3sRe4RtpM+K6AxR/jBXJGDn0vIvuzixxDJcqZfo7qBtnQUwi/B12BY8rvvkX9s0kIz/QShGcap0qMagizQsX1NgjvKrNS5Rlu3j9SkYhzxCWbFbiAidrQA3xuSPXcmL+sxobE9Vb0uUxLCVtEnJe0CqHzphi7CiVmw9V+CtNS/gh40WvCkq6L7RRtYpN41iTazwPYYzGxH54nfGxw2W4geCILmHiSmFD6Ka/SNlw/YhBog7Aiu9oCJew7bki2SYxhqlEW+g0lPLecH1jw+FS5G/N6wXCME4kCy+CbkrZbnm3eRGyXNM2598Q6EgVmqfsUDqps6ZChsp1SDgVkwhlGUsuEPI34RES3nJtDim3qCxGH2PWE+Si6uouogzjKvUWYgVCZKocCDqKFXxHXh3g/WsT+Po93e4vpP2Kl/q+ECLULUDJwFv3QGTmeD907lHoFgtApIFKK/e/+rVJp9J8AAwCOzjQoqkUfeAAAAABJRU5ErkJggg==" alt="" style="width:36px;height:36px;-webkit-animation:dialogLoading 1s linear infinite;animation:dialogLoading 1s linear infinite;display: block;margin: 0 auto;margin-bottom: 2px;">
        <p style="width: 100%;height: 20px;text-align: center;font-size: 15px;color: #000;line-height: 20px;color: #fff">正在加载...</p>
    </div>
</div>
</body>
<script src="js/jquery-1.11.2.min.js"></script>
<script src="js/swiper.min.js"></script>
<script src="https://cdn.bootcss.com/html2canvas/0.5.0-beta4/html2canvas.js"></script>
<script type="text/javascript">
    var sure_url = "/h5/cd/luck.html";
    $(function() {
        //滑动页面
        var mySwiper = new Swiper('.swiper-container', {
            direction: 'horizontal',
            pagination: '.swiper-pagination',
            mousewheelControl: true,
            observer: true,
            observeParents: true,
            noSwiping: true,
            nested: true,
            onSlideChangeEnd: function (swiper) {
                console.log(swiper.activeIndex);
            },
        });

        var type_name="";
        //四大分类切换
        $(".page2 .box3").click(function(){
            $(".page2 .box3").removeClass("active");
            $(this).addClass("active");
            type_name=$(this).attr("data-name");
        });

        //类型点击确认
        $(".page2 .box2").click(function(){
            if(type_name==""){
                alert("请选择一个类型哦~")
                return;
            }
            mySwiper.slideNext();
        });
        //名字点击确认截屏
        $(".page3 .box2").click(function(){
            $(".js_load").show();


            var user_name=$(".name_input input").val();
            var srf = $('meta[name="csrf-token"]').attr('content');
            if(user_name==""||user_name==undefined){
                alert("亲，姓名不能为空哦~");
                return;
            }
//            $.post(sure_url,{"name":user_name,"luck":type_name,"_csrf_frontend":srf},function(data){
//                if(data.status == 0){
//                    $(".username").text(data.data.name);
//                    var type_name=data.data.word_name;
//                    if(type_name=="aq"){
//                        $(".type").text("爱情");
//                    }else if(type_name=="xy"){
//                        $(".type").text("学业");
//                    }else if(type_name=="zc"){
//                        $(".type").text("职场");
//                    }else if(type_name=="cy"){
//                        $(".type").text("财运");
//                    }
//                    $(".txt").text(data.data.word_info);

                    mySwiper.slideNext();

                    var canvas2 = document.createElement("canvas");
                    let _canvas = document.querySelector('.page4');
                    var w = parseInt(window.getComputedStyle(_canvas).width);
                    var h = parseInt(window.getComputedStyle(_canvas).height);
                    canvas2.width = w * 2;
                    canvas2.height = h * 2;
                    canvas2.style.width = w + "px";
                    canvas2.style.height = h + "px";
                    var context = canvas2.getContext("2d");
                    context.scale(2,2);
                    html2canvas(_canvas,{canvas:canvas2}).then(function(canvas) {
                        console.log(canvas.toDataURL());
                        $(".js_load").hide();
                        $(".jp_img").attr("src",canvas.toDataURL());
                        $(".page4").addClass("hidden");
                        mySwiper.update();
                        $(".from").hide();
                    });

//                }else{
//                    alert(data.msg);
//                }
//            } ,'json');
        });
        //测测其他
        $(".again").click(function(){
            window.location.href = location.href+'?time='+((new Date()).getTime());
        });
    });
</script>
</html>