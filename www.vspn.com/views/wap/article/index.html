<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
        <meta name="keywords" content="量子体育VSPN 乐竞文化传媒（上海）有限公司 量子体育VSPN首页 量子体育VSPN电竞商业化 量子体育VSPN赛事运营 量子体育VSPN节目制作">
        <meta name="description" content="量子体育VSPN（Versus Programming Network）运营国内顶级职业赛事，制作水准超越传统体育；打造游戏、电竞泛娱乐内容，引领行业发展新思路">
        <link rel="stylesheet" type="text/css" href="{$smarty.const.STATIC_DOMAIN}1.0/m/css/common.css?{$smarty.const.VERSION}">
        <link rel="stylesheet" href="{$smarty.const.STATIC_DOMAIN}1.0/m/css/public.css?{$smarty.const.VERSION}">
        <link rel="stylesheet" type="text/css" href="{$smarty.const.STATIC_DOMAIN}1.0/m/css/news.css?{$smarty.const.VERSION}">
        <script src="{$smarty.const.STATIC_DOMAIN}1.0/m/js/jquery-1.11.2.min.js?{$smarty.const.VERSION}"></script>
        <title>新闻动态</title>
         <script>
            (function(doc, win) {
                var docEl = doc.documentElement,
                    // 手机旋转事件,大部分手机浏览器都支持 onorientationchange 如果不支持，可以使用原始的 resize
                    resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize',
                    recalc = function() {
                        //clientWidth: 获取对象可见内容的宽度，不包括滚动条，不包括边框
                        var clientWidth = docEl.clientWidth;
                        if(!clientWidth) return;
                        docEl.style.fontSize = 16 * (clientWidth / 320) + 'px';
                    };

                recalc();
                //判断是否支持监听事件 ，不支持则停止
                if(!doc.addEventListener) return;
                //注册翻转事件
                win.addEventListener(resizeEvt, recalc, false);

            })(document, window);
        </script>
</head>
<body>
  <div id="main" class="top_content">
    {include '../../layouts/wap/header.html'}
            <div class="part_con" style="width: 20rem;height: 6.875rem;position: relative;top: 4.03125rem;">
                <div class="logo_img">
                </div>
            </div>
    <!-- 下方内容 -->
    <div class="content">
      <div class="news_list">
        <ul id="news_list_ul" data-id="{$id}">
          {if !empty($data)}
          {foreach $data as $v}
          <li>
            <a target="_blank" href="{$v.linkUrl}">
              <span class="news_title">{$v.title}</span>
              <span class="news_time">{$v.created_at_formate}</span>
            </a>
          </li>
          {/foreach}
          {else}
          <div class="noData" style="line-height: 200px;color: #ab9365;text-align: center;font-size: 22px;">暂无数据</div>
          {/if}
        </ul>
        <div id="page" class="right"><div name="laypage1.3" class="laypage_main laypageskin_default" id="laypage_1"><a href="javascript:;" class="laypage_prev">上一页</a><a href="javascript:;" class="laypage_next">下一页</a></div></div>
      </div>


    </div>
    {include '../../layouts/wap/footer.html'}
  </div>
</body>
<script src="{$smarty.const.STATIC_DOMAIN}1.0/m/js/jquery-1.11.2.min.js?{$smarty.const.VERSION}"></script>
<script type="text/javascript">
   var clickNumber=0;
        $(".h_nav").on("click", function(e) {
        e.stopPropagation();
        if(clickNumber % 2 == 0) {
            $(".d_t_t").addClass("d_t_t_tran");
            $(".d_t_b").addClass("d_t_b_tran");
            $(".header_nav").stop().slideDown();
        } else {
            $(".d_t_t").removeClass("d_t_t_tran");
            $(".d_t_b").removeClass("d_t_b_tran");
            $(".header_nav").stop().slideUp();
        }
        clickNumber++;
    });
    $(".header_nav li,.fade,.header_nav").click(function() {
        $(".d_t_t").removeClass("d_t_t_tran");
        $(".d_t_m").removeClass("d_t_m_tran");
        $(".d_t_b").removeClass("d_t_b_tran");
        $(".header_nav").stop().slideUp();
        clickNumber = 0;
    })
    
	var isScroll = 1;//是否可以滚动
    var page = 1; //页数
    var page2="";
    var id = $("#news_list_ul").attr("data-id");//类型
    var ajaxUrl = '{myurl name="commonMethod/ajax-get-list"}';
    getListFu();
    window.onscroll=function(){
        var winH = window.innerHeight; //屏幕高度
        var allH = document.body.scrollHeight; //总高度
        var topH = window.pageYOffset; //滚动高度
        if((allH - (winH
                + topH)<10) && isScroll == 1){
            isScroll = 0;
        }
    }
    function getListFu(){
        $.ajax({
            type:"get",
            url:ajaxUrl,
            data:{
                page:page,
                id:id,
            },
            success:function(data){
                var data = JSON.parse(data);
                var result = '';
                $('#news_list_ul').html("");
                if(data.status == 0&& data.msg.length>0){
                    for(var i = 0; i < data.msg.length; i++) {
                        result += "<li><a href=" + data.msg[i].wapLinkUrl+"><span>"+data.msg[i].title+"</span><span>"+data.msg[i].created_at+"</span></a></li>";
                    }
                    if(data.msg.length<9){
                         $(".list-info .list-article").css("height","auto");
                    }

                    $('#news_list_ul').append(result);
                    $(".noData").hide();
                    page2=page;
                }else{
                     result += "";
                    $(".list-info .list-article").css("height","auto");
                         $(".more").hide();
                    $('#news_list_ul').append(result);
                     $(".noData").html("暂无数据...");
                }
            },
            error:function(data){
                console.log(data);
            }
        });
    }
     function getListFu2(){
        $.ajax({
            type:"get",
            url:ajaxUrl,
            data:{
                page:page2,
                id:id,
            },
            success:function(data){
                var data = JSON.parse(data);
                var result = '';
                $('#news_list_ul').html("");
                if(data.status == 0&& data.msg.length>0){
                    for(var i = 0; i < data.msg.length; i++) {
                        result += "<li><a href=" + data.msg[i].wapLinkUrl+"><span>"+data.msg[i].title+"</span><span>"+data.msg[i].created_at+"</span></a></li>";
                    }
                    if(data.msg.length<9){
                         $(".list-info .list-article").css("height","auto");
                    }

                    $('#news_list_ul').append(result);
                    $(".noData").hide();
                }else{
                     result += "";
                    $(".list-info .list-article").css("height","auto");
                         $(".more").hide();
                    $('#news_list_ul').append(result);
                     $(".noData").html("暂无数据...");
                }
            },
            error:function(data){
                console.log(data);
            }
        });
    }
    $(".laypage_next").click(function(){
        page2++;
        if(page2>17){
            page2=17;
        }

        getListFu2();
        console.log(page2);
    });
     $(".laypage_prev").click(function(){
        if(page2<1){
            page2=1;
        }
        page2--;
        getListFu2();
        console.log(page2);
    })
</script>
</html>